<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HISTORY | KMA 한국대표단</title>

    <link rel="stylesheet" href="../css/font.css">
    <link rel="stylesheet" href="../css/common.css">
    <link rel="stylesheet" href="../css/sub.css">

    <script src="../js/header.js"></script>
   
</head>
<body>
    <div id="container">

        <!-- header -->
        <div id="header">
            <a href="../index.html"><img src="../assets/imgs/atdLogo4.webp" alt="ATD2025 logo" class="header-logo"></a>
        
            <div class="pc-cate">
                <ul class="main-cate">
                    <li>ATD 25<img src="../assets/icons/icon_arrow_r.svg" alt="화살표"></li>
                    <li>KMA-ATD 25<img src="../assets/icons/icon_arrow_r.svg" alt="화살표"></li>
                    <li><a href="../program/5.html">K-TD</a></li>
                    <li><a href="../faq/1.html">FAQ</a></li>
                    <li><a href="../etc/hstr.html">HISTORY</a></li>
                </ul>
                <ul class="sub-cate-1 sub-cate">
                    <li><a href="../atd25/abtAtd25.html">About ATD 25</a></li>
                    <li><a href="../atd25/kntSpk.html">키노트 스피커</a></li>
                    <li><a href="../atd25/lngTr.html">학습 과정</a></li>
                    <li><a href="../atd25/scd.html">일정</a></li>
                </ul>
                <ul class="sub-cate-2 sub-cate">
                    <li><a href="../kmaAtd25/team.html">팀별 일정표</a></li>
                    <li><a href="../kmaAtd25/spcPrg.html">스페셜 프로그램</a></li>
                    <li><a href="../kmaAtd25/cdnGrp.html">코디네이터 그룹</a></li>
                    <li><a href="../kmaAtd25/cost.html">참가비용</a></li>
                </ul>
            </div>
            
            <button class="menu-btn"></button>

            <!-- menu-wrap -->
            <div class="cate-wrap">
                <div class="top">
                    <button class="close-btn"></button>
                </div>
                <ul class="cate">
                    <li><a href="">HOME</a></li>
                    <li>
                        ATD 25
                        <ul>
                            <li><a href="../atd25/abtAtd25.html">About ATD 2025</a></li>
                            <li><a href="../atd25/kntSpk.html">키노트 스피커</a></li>
                            <li><a href="../atd25/lngTr.html">학습 과정</a></li>
                            <li><a href="../atd25/scd.html">일정</a></li>
                        </ul>
                    </li>
                    <li>
                        KMA ATD 25
                        <ul>
                            <li><a href="../kmaAtd25/team.html">팀별 일정표</a></li>
                            <li><a href="../kmaAtd25/spcPrg.html">스페셜 프로그램</a></li>
                            <li><a href="../kmaAtd25/cdnGrp.html">코디네이터 그룹</a></li>
                            <li><a href="../kmaAtd25/ktdPrg.html">K-TD 프로그램</a></li>
                            <li><a href="../kmaAtd25/cost.html">참가비용</a></li>
                        </ul>
                    </li>
                    <li><a href="../program/5.html">K-TD</a></li>
                    <li><a href="../faq/1.html">FAQ</a></li>
                    <li><a href="../etc/hstr.html">HISTORY</a></li>
                </ul>
            </div>

            <div class="bg-over"></div>
        </div>

        <!-- pg-top -->
        <div class="pg-top">
            <div class="pg-wrap">
                <p class="pg-sub">히스토리<br></p>
                <p class="pg-tit">HISTORY</p>
            </div>
            <img src="../assets/imgs/img_pgt5.svg" alt="ATD 25" class="pgt-img pgt-img5">
        </div>

        <div class="hstr-wrap">
            <div id="gallery"></div>
            <div id="loading">
                <button id="loadMore">더보기</button>
            </div>
        </div>
    </div>

    <!-- 팝업 요소 -->
    <div id="popup" class="hidden">
        <div class="popup-content">
            <button id="closePopup" class="close-btn"></button>
            <img id="popupImage" src="" alt="확대된 이미지">
        </div>
    </div> 

   <!-- footer -->
   <footer id="footer">
    <div class="footer-wrap">
        <div class="footer-top">
            <img src="../assets/imgs/logo_atd_w.webp" alt="ATD 한국대표단" class="logo">

            <div class="footer-cate">
            <a href="../index.html">HOME</a>
            <!-- <span>|</span> -->
            <a href="../atd25/abtAtd25.html">ATD 25</a>
            <!-- <span>|</span> -->
            <a href="../kmaAtd25/ktdPrg.html">KMA-ATD 25</a>
            <!-- <span>|</span> -->
            <a href="../faq/1.html">FAQ</a>
            <a href="../etc/hstr.html">HISTORY</a>
            <a href="../etc/contact.html">CONTACT</a>
            </div>
        </div>

        <div class="footer-bottom">
            <div class="f-b-l">
                <button class="download">
                <a href=""></a>
                KMA-ATD 25 소개 브로셔
                </button>
                <button class="download">
                    <a href=""></a>
                    KMA-ATD 개인&단체 신청양식
                </button>
            </div>

            <div class="f-b-r">
                <div class="r-txt-wrap">
                <p class="r-txt">
                    KMA-ATD 한국대표단 운영사무국
                </p>
                <p class="r-txt">
                    <span>Tel.</span>
                    <a href="tel:0232749386">02.3274.9386/</a>
                    <a href="tel:0232749388">9388/</a>
                    <a href="tel:0232749340">9340</a>
                </p>
                <p class="r-txt">
                    <span>Mail.</span>
                    <a href="mailto:atd@kma.or.kr">atd@kma.or.kr</a>
                </p>
                <!-- <p class="r-txt">
                    <span>Company.</span>
                    22, Uisadang-daero, Yeongdeungpo-gu, Seoul
                </p> -->
                </div>

                
            </div>
        </div>
    </div>
</footer>
<div class="copy-wrap">
    <p class="copy">@ 2025 KMA</p>
</div>
<!-- //footer -->

    <script src="https://unpkg.com/imagesloaded@4/imagesloaded.pkgd.min.js"></script>
    <script>
        document.addEventListener("DOMContentLoaded", () => {
            const gallery = document.getElementById("gallery");
            const loadMoreButton = document.getElementById("loadMore");

            if (!gallery || !loadMoreButton) {
                console.error("❌ 필수 DOM 요소를 찾을 수 없습니다.");
                return;
            }

            let images = []; // JSON 데이터를 저장할 배열
            let currentIndex = 0; // 현재 인덱스
            const batchSize = 20; // 한 번에 불러올 이미지 개수

            // JSON 데이터 로드
            fetch("image.json")
                .then((response) => {
                    if (!response.ok) throw new Error("❌ JSON 파일을 불러올 수 없습니다.");
                    return response.json();
                })
                .then((data) => {
                    images = data.length > 0 ? data : [{ src: "placeholder.jpg" }];
                    loadImages(); // 처음 이미지를 로드
                    loadMoreButton.style.display = "block";
                })
                .catch((error) => {
                    console.error(error);
                    loadMoreButton.style.display = "none";
                });

            // Masonry 레이아웃 조정 함수
            function resizeGridItems() {
                const items = document.querySelectorAll('.gallery-item');
                items.forEach(item => {
                    const rowHeight = parseInt(window.getComputedStyle(gallery).getPropertyValue('grid-auto-rows'));
                    const rowGap = parseInt(window.getComputedStyle(gallery).getPropertyValue('gap'));
                    const img = item.querySelector('img');

                    if (img.complete) {
                        const rowSpan = Math.ceil((img.offsetHeight + rowGap) / (rowHeight + rowGap));
                        item.style.gridRowEnd = `span ${rowSpan}`;
                        item.style.minHeight = "100px"; // 최소 높이 적용
                    } else {
                        img.addEventListener('load', () => {
                            const rowSpan = Math.ceil((img.offsetHeight + rowGap) / (rowHeight + rowGap));
                            item.style.gridRowEnd = `span ${rowSpan}`;
                            item.style.minHeight = "100px"; // 최소 높이 적용
                        });
                    }
                });
            }

            // 이미지 추가 함수
            function loadImages() {
                const fragment = document.createDocumentFragment();

                for (let i = currentIndex; i < currentIndex + batchSize; i++) {
                    if (i >= images.length) break;

                    const item = document.createElement("div");
                    item.classList.add("gallery-item");

                    const img = document.createElement("img");
                    img.src = images[i].src;
                    img.alt = `갤러리 이미지 ${i + 1}`;
                    img.loading = "lazy";
                    img.onerror = () => {
                        img.src = "placeholder.jpg";
                        console.error(`❌ 이미지 로드 실패: ${img.src}`);
                    };

                    item.appendChild(img);
                    fragment.appendChild(item);
                }

                gallery.appendChild(fragment);
                resizeGridItems(); // Masonry 레이아웃 조정

                currentIndex += batchSize;

                if (currentIndex >= images.length) {
                    loadMoreButton.style.display = "none"; // 더 이상 로드할 이미지가 없으면 버튼 숨기기
                    const noMoreText = document.createElement("p");
                    noMoreText.innerText = " ";
                    document.getElementById("loading").appendChild(noMoreText);
                }
            }

            // 더보기 버튼 클릭 이벤트
            loadMoreButton.addEventListener("click", () => loadImages());

            // 창 크기가 변경될 때 Masonry 레이아웃 재조정
            window.addEventListener('resize', resizeGridItems);
        });
    </script>

</body>
</html>