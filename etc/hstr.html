<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HISTORY | KMA 한국대표단</title>

    <link rel="stylesheet" href="../css/font.css">
    <link rel="stylesheet" href="../css/common.css">
    <link rel="stylesheet" href="../css/sub.css">

    <script src="../js/header.js"></script>
</head>
<body>
    <div id="container">

        <!-- header -->
        <div id="header">
            <a href="../index.html"><img src="../assets/imgs/atdLogo4.webp" alt="ATD2025 logo" class="header-logo"></a>
        
            <div class="pc-cate">
                <ul class="main-cate">
                    <li>ATD 25</li>
                    <li>KMA-ATD 25</li>
                    <li><a href="https://www.atdconference.td.org/program/sessions" target="_blank">SESSIONS</a></li>
                    <li><a href="../etc/faq.html">FAQ</a></li>
                    <li><a href="../etc/hstr.html">HISTORY</a></li>
                </ul>
                <ul class="sub-cate-1 sub-cate">
                    <li><a href="../atd25/abtAtd25.html">About ATD 25</a></li>
                    <li><a href="../atd25/kntSpk.html">키노트 스피커</a></li>
                    <li><a href="../atd25/lngTr.html">학습 과정</a></li>
                    <li><a href="../atd25/scd.html">일정</a></li>
                </ul>
                <ul class="sub-cate-2 sub-cate">
                    <li><a href="../kmaAtd25/team.html">팀별 일정표</a></li>
                    <li><a href="../kmaAtd25/spcPrg.html">스페셜 프로그램</a></li>
                    <li><a href="../kmaAtd25/cdnGrp.html">코디네이터 그룹</a></li>
                    <li><a href="../kmaAtd25/cost.html">참가비용</a></li>
                </ul>
            </div>
            
            <button class="menu-btn"></button>

            <!-- menu-wrap -->
            <div class="cate-wrap">
                <div class="top">
                    <button class="close-btn"></button>
                </div>
                <ul class="cate">
                    <li><a href="">HOME</a></li>
                    <li>
                        ATD 25
                        <ul>
                            <li><a href="../atd25/abtAtd25.html">About ATD 2025</a></li>
                            <li><a href="../atd25/kntSpk.html">키노트 스피커</a></li>
                            <li><a href="../atd25/lngTr.html">학습 과정</a></li>
                            <li><a href="../atd25/scd.html">일정</a></li>
                        </ul>
                    </li>
                    <li>
                        KMA ATD 25
                        <ul>
                            <li><a href="../kmaAtd25/team.html">팀별 일정표</a></li>
                            <li><a href="../kmaAtd25/spcPrg.html">스페셜 프로그램</a></li>
                            <li><a href="../kmaAtd25/cdnGrp.html">코디네이터 그룹</a></li>
                            <li><a href="../kmaAtd25/ktdPrg.html">K-TD 프로그램</a></li>
                            <li><a href="../kmaAtd25/cost.html">참가비용</a></li>
                        </ul>
                    </li>
                    <li><a href="https://www.atdconference.td.org/program/sessions" target="_blank">SESSIONS</a></li>
                    <li><a href="../etc/faq.html">FAQ</a></li>
                    <li><a href="../etc/hstr.html">HISTORY</a></li>
                </ul>
            </div>

            <div class="bg-over"></div>
        </div>

        <!-- pg-top -->
        <div class="pg-top" style="background-image: url('/assets/imgs/img_t_bg.webp');">
            <p class="pg-tit">HISTORY</p>
        </div>

        <div class="gallery-container">
            <div class="gallery" id="gallery"></div>
            <div class="loading" id="loading">로딩 중...</div>
        </div>
    </div>

    <script>
        document.addEventListener("DOMContentLoaded", () => {
            const gallery = document.getElementById("gallery");
            const loading = document.getElementById("loading");
            let images = []; 
            let currentIndex = 0;
            const batchSize = 20; // 한 번에 불러올 개수

            // JSON에서 이미지 불러오기
            fetch("image.json")
                .then(response => response.json())
                .then(data => {
                    images = data;
                    loadImages(); // 처음 20개 로드
                })
                .catch(error => console.error("❌ 이미지 로드 실패:", error));

            // 이미지 로드 함수
            function loadImages() {
                console.log("📢 loadImages() 실행됨!");
                const fragment = document.createDocumentFragment();
                let loaded = 0;

                for (let i = currentIndex; i < currentIndex + batchSize; i++) {
                    if (i >= images.length) {
                        loading.innerText = "더 이상 이미지가 없습니다.";
                        return;
                    }

                    let img = document.createElement("img");
                    img.src = images[i].src;
                    img.alt = `갤러리 이미지 ${i + 1}`;
                    img.loading = "lazy"; // 성능 최적화
                    img.onerror = () => console.error("❌ 이미지 로드 실패:", img.src);
                    
                    fragment.appendChild(img);
                    loaded++;
                }

                gallery.appendChild(fragment);
                currentIndex += batchSize;

                console.log(`🎯 ${loaded}개 이미지 추가 완료! 현재 인덱스: ${currentIndex}`);
            }

            // 스크롤 이벤트 (무한 스크롤)
            window.addEventListener("scroll", () => {
                if (window.innerHeight + window.scrollY >= document.body.offsetHeight - 100) {
                    loadImages();
                }
            });
        });
    </script>
</body>
</html>